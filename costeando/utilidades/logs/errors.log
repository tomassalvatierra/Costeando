2025-07-11 11:57:34 - costeando.modulos.procesamiento_primer_comprando - ERROR - Error en procesamiento primer comprando: 'Codigo'
Traceback (most recent call last):
  File "C:\Users\tsalvatierra\AppData\Local\Programs\Python\Python311\Lib\site-packages\pandas\core\indexes\base.py", line 3653, in get_loc
    return self._engine.get_loc(casted_key)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "pandas\_libs\index.pyx", line 147, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\_libs\index.pyx", line 176, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\_libs\hashtable_class_helper.pxi", line 7080, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas\_libs\hashtable_class_helper.pxi", line 7088, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Codigo'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\tsalvatierra\Desktop\Proyectos\Costeando1.1\costeando\modulos\procesamiento_primer_comprando.py", line 185, in procesar_primer_comprando
    df_compras['Codigo'] = df_compras['Codigo'].astype(str).str.strip()
                           ~~~~~~~~~~^^^^^^^^^^
  File "C:\Users\tsalvatierra\AppData\Local\Programs\Python\Python311\Lib\site-packages\pandas\core\frame.py", line 3761, in __getitem__
    indexer = self.columns.get_loc(key)
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\tsalvatierra\AppData\Local\Programs\Python\Python311\Lib\site-packages\pandas\core\indexes\base.py", line 3655, in get_loc
    raise KeyError(key) from err
KeyError: 'Codigo'
2025-07-11 11:57:34 - costeando.gui.primer_comprando_window - ERROR - Error en el procesamiento de primer comprando: 'Codigo'
Traceback (most recent call last):
  File "C:\Users\tsalvatierra\AppData\Local\Programs\Python\Python311\Lib\site-packages\pandas\core\indexes\base.py", line 3653, in get_loc
    return self._engine.get_loc(casted_key)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "pandas\_libs\index.pyx", line 147, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\_libs\index.pyx", line 176, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\_libs\hashtable_class_helper.pxi", line 7080, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas\_libs\hashtable_class_helper.pxi", line 7088, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Codigo'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\tsalvatierra\Desktop\Proyectos\Costeando1.1\costeando\gui\primer_comprando_window.py", line 151, in procesar_primer_comprando
    resultado = procesar_primer_comprando(
                ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\tsalvatierra\Desktop\Proyectos\Costeando1.1\costeando\modulos\procesamiento_primer_comprando.py", line 185, in procesar_primer_comprando
    df_compras['Codigo'] = df_compras['Codigo'].astype(str).str.strip()
                           ~~~~~~~~~~^^^^^^^^^^
  File "C:\Users\tsalvatierra\AppData\Local\Programs\Python\Python311\Lib\site-packages\pandas\core\frame.py", line 3761, in __getitem__
    indexer = self.columns.get_loc(key)
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\tsalvatierra\AppData\Local\Programs\Python\Python311\Lib\site-packages\pandas\core\indexes\base.py", line 3655, in get_loc
    raise KeyError(key) from err
KeyError: 'Codigo'
2025-07-14 12:16:02 - costeando.gui.actualizacion_fchs_window - ERROR - Error en la actualizaci√≥n de fechas: Faltan columnas en estructuras: ['CODIGO_PLANO']
Traceback (most recent call last):
  File "C:\Users\tsalvatierra\Desktop\Proyectos\Costeando1.1\costeando\gui\actualizacion_fchs_window.py", line 102, in procesar_actualizacion_fechas
    resultado = procesar_actualizacion_fchs_puro(
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\tsalvatierra\Desktop\Proyectos\Costeando1.1\costeando\modulos\procesamiento_actualizacion_fchs.py", line 101, in procesar_actualizacion_fchs_puro
    validar_columnas(df_estructuras, ["COD_NIVEL0", "CODIGO_PLANO"], "estructuras")
  File "C:\Users\tsalvatierra\Desktop\Proyectos\Costeando1.1\costeando\utilidades\validaciones.py", line 13, in validar_columnas
    raise ValueError(f"Faltan columnas en {nombre_df}: {faltantes}")
ValueError: Faltan columnas en estructuras: ['CODIGO_PLANO']
2025-07-15 10:27:43 - costeando.gui.leader_list_window - ERROR - Error en el procesamiento de leader list: 'str' object has no attribute 'columns'
Traceback (most recent call last):
  File "C:\Users\tsalvatierra\Desktop\Proyectos\Costeando1.1\costeando\gui\leader_list_window.py", line 127, in procesar_leader_list
    resultado = procesar_leader_list_puro(
                ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\tsalvatierra\Desktop\Proyectos\Costeando1.1\costeando\modulos\procesamiento_leader_list.py", line 82, in procesar_leader_list_puro
    lista_dfs = [estandarizar_columna_producto(df, nombre) for df, nombre in lista_dfs]
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\tsalvatierra\Desktop\Proyectos\Costeando1.1\costeando\modulos\procesamiento_leader_list.py", line 82, in <listcomp>
    lista_dfs = [estandarizar_columna_producto(df, nombre) for df, nombre in lista_dfs]
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\tsalvatierra\Desktop\Proyectos\Costeando1.1\costeando\modulos\procesamiento_leader_list.py", line 10, in estandarizar_columna_producto
    if 'Producto' in df.columns:
                     ^^^^^^^^^^
AttributeError: 'str' object has no attribute 'columns'
2025-07-15 10:28:01 - costeando.gui.leader_list_window - ERROR - Error en el procesamiento de leader list: invalid command name ".!leaderlistwindow.!progressbar"
Traceback (most recent call last):
  File "C:\Users\tsalvatierra\Desktop\Proyectos\Costeando1.1\costeando\gui\leader_list_window.py", line 95, in procesar_con_progreso
    self.procesar_leader_list()
  File "C:\Users\tsalvatierra\Desktop\Proyectos\Costeando1.1\costeando\gui\leader_list_window.py", line 143, in procesar_leader_list
    self.ocultar_progreso()
  File "C:\Users\tsalvatierra\Desktop\Proyectos\Costeando1.1\costeando\gui\leader_list_window.py", line 86, in ocultar_progreso
    self.progress_bar.stop()
  File "C:\Users\tsalvatierra\AppData\Local\Programs\Python\Python311\Lib\tkinter\ttk.py", line 1003, in stop
    self.tk.call(self._w, "stop")
_tkinter.TclError: invalid command name ".!leaderlistwindow.!progressbar"
2025-07-15 10:30:29 - costeando.gui.leader_list_window - ERROR - Error en el procesamiento de leader list: name 'Codigo' is not defined
Traceback (most recent call last):
  File "C:\Users\tsalvatierra\AppData\Local\Programs\Python\Python311\Lib\site-packages\pandas\core\computation\scope.py", line 233, in resolve
    return self.resolvers[key]
           ~~~~~~~~~~~~~~^^^^^
  File "C:\Users\tsalvatierra\AppData\Local\Programs\Python\Python311\Lib\collections\__init__.py", line 1004, in __getitem__
    return self.__missing__(key)            # support subclasses that define __missing__
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\tsalvatierra\AppData\Local\Programs\Python\Python311\Lib\collections\__init__.py", line 996, in __missing__
    raise KeyError(key)
KeyError: 'Codigo'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\tsalvatierra\AppData\Local\Programs\Python\Python311\Lib\site-packages\pandas\core\computation\scope.py", line 244, in resolve
    return self.temps[key]
           ~~~~~~~~~~^^^^^
KeyError: 'Codigo'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\tsalvatierra\Desktop\Proyectos\Costeando1.1\costeando\gui\leader_list_window.py", line 127, in procesar_leader_list
    resultado = procesar_leader_list_puro(
                ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\tsalvatierra\Desktop\Proyectos\Costeando1.1\costeando\modulos\procesamiento_leader_list.py", line 85, in procesar_leader_list_puro
    df_leader_list = df_leader_list.query("Codigo not in [99000, 99001, 99002, 99003, 99004, 99005]")
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\tsalvatierra\AppData\Local\Programs\Python\Python311\Lib\site-packages\pandas\core\frame.py", line 4440, in query
    res = self.eval(expr, **kwargs)
          ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\tsalvatierra\AppData\Local\Programs\Python\Python311\Lib\site-packages\pandas\core\frame.py", line 4566, in eval
    return _eval(expr, inplace=inplace, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\tsalvatierra\AppData\Local\Programs\Python\Python311\Lib\site-packages\pandas\core\computation\eval.py", line 336, in eval
    parsed_expr = Expr(expr, engine=engine, parser=parser, env=env)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\tsalvatierra\AppData\Local\Programs\Python\Python311\Lib\site-packages\pandas\core\computation\expr.py", line 809, in __init__
    self.terms = self.parse()
                 ^^^^^^^^^^^^
  File "C:\Users\tsalvatierra\AppData\Local\Programs\Python\Python311\Lib\site-packages\pandas\core\computation\expr.py", line 828, in parse
    return self._visitor.visit(self.expr)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\tsalvatierra\AppData\Local\Programs\Python\Python311\Lib\site-packages\pandas\core\computation\expr.py", line 415, in visit
    return visitor(node, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\tsalvatierra\AppData\Local\Programs\Python\Python311\Lib\site-packages\pandas\core\computation\expr.py", line 421, in visit_Module
    return self.visit(expr, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\tsalvatierra\AppData\Local\Programs\Python\Python311\Lib\site-packages\pandas\core\computation\expr.py", line 415, in visit
    return visitor(node, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\tsalvatierra\AppData\Local\Programs\Python\Python311\Lib\site-packages\pandas\core\computation\expr.py", line 424, in visit_Expr
    return self.visit(node.value, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\tsalvatierra\AppData\Local\Programs\Python\Python311\Lib\site-packages\pandas\core\computation\expr.py", line 415, in visit
    return visitor(node, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\tsalvatierra\AppData\Local\Programs\Python\Python311\Lib\site-packages\pandas\core\computation\expr.py", line 719, in visit_Compare
    return self.visit(binop)
           ^^^^^^^^^^^^^^^^^
  File "C:\Users\tsalvatierra\AppData\Local\Programs\Python\Python311\Lib\site-packages\pandas\core\computation\expr.py", line 415, in visit
    return visitor(node, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\tsalvatierra\AppData\Local\Programs\Python\Python311\Lib\site-packages\pandas\core\computation\expr.py", line 535, in visit_BinOp
    op, op_class, left, right = self._maybe_transform_eq_ne(node)
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\tsalvatierra\AppData\Local\Programs\Python\Python311\Lib\site-packages\pandas\core\computation\expr.py", line 455, in _maybe_transform_eq_ne
    left = self.visit(node.left, side="left")
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\tsalvatierra\AppData\Local\Programs\Python\Python311\Lib\site-packages\pandas\core\computation\expr.py", line 415, in visit
    return visitor(node, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\tsalvatierra\AppData\Local\Programs\Python\Python311\Lib\site-packages\pandas\core\computation\expr.py", line 548, in visit_Name
    return self.term_type(node.id, self.env, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\tsalvatierra\AppData\Local\Programs\Python\Python311\Lib\site-packages\pandas\core\computation\ops.py", line 86, in __init__
    self._value = self._resolve_name()
                  ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\tsalvatierra\AppData\Local\Programs\Python\Python311\Lib\site-packages\pandas\core\computation\ops.py", line 110, in _resolve_name
    res = self.env.resolve(local_name, is_local=is_local)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\tsalvatierra\AppData\Local\Programs\Python\Python311\Lib\site-packages\pandas\core\computation\scope.py", line 246, in resolve
    raise UndefinedVariableError(key, is_local) from err
pandas.errors.UndefinedVariableError: name 'Codigo' is not defined
2025-07-15 10:50:11 - costeando.gui.leader_list_window - ERROR - Error en el procesamiento de leader list: name 'Codigo' is not defined
Traceback (most recent call last):
  File "C:\Users\tsalvatierra\AppData\Local\Programs\Python\Python311\Lib\site-packages\pandas\core\computation\scope.py", line 233, in resolve
    return self.resolvers[key]
           ~~~~~~~~~~~~~~^^^^^
  File "C:\Users\tsalvatierra\AppData\Local\Programs\Python\Python311\Lib\collections\__init__.py", line 1004, in __getitem__
    return self.__missing__(key)            # support subclasses that define __missing__
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\tsalvatierra\AppData\Local\Programs\Python\Python311\Lib\collections\__init__.py", line 996, in __missing__
    raise KeyError(key)
KeyError: 'Codigo'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\tsalvatierra\AppData\Local\Programs\Python\Python311\Lib\site-packages\pandas\core\computation\scope.py", line 244, in resolve
    return self.temps[key]
           ~~~~~~~~~~^^^^^
KeyError: 'Codigo'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\tsalvatierra\Desktop\Proyectos\Costeando1.1\costeando\gui\leader_list_window.py", line 127, in procesar_leader_list
    resultado = procesar_leader_list_puro(
                ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\tsalvatierra\Desktop\Proyectos\Costeando1.1\costeando\modulos\procesamiento_leader_list.py", line 88, in procesar_leader_list_puro
    df_leader_list = df_leader_list.query("Codigo not in [99000, 99001, 99002, 99003, 99004, 99005]")
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\tsalvatierra\AppData\Local\Programs\Python\Python311\Lib\site-packages\pandas\core\frame.py", line 4440, in query
    res = self.eval(expr, **kwargs)
          ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\tsalvatierra\AppData\Local\Programs\Python\Python311\Lib\site-packages\pandas\core\frame.py", line 4566, in eval
    return _eval(expr, inplace=inplace, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\tsalvatierra\AppData\Local\Programs\Python\Python311\Lib\site-packages\pandas\core\computation\eval.py", line 336, in eval
    parsed_expr = Expr(expr, engine=engine, parser=parser, env=env)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\tsalvatierra\AppData\Local\Programs\Python\Python311\Lib\site-packages\pandas\core\computation\expr.py", line 809, in __init__
    self.terms = self.parse()
                 ^^^^^^^^^^^^
  File "C:\Users\tsalvatierra\AppData\Local\Programs\Python\Python311\Lib\site-packages\pandas\core\computation\expr.py", line 828, in parse
    return self._visitor.visit(self.expr)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\tsalvatierra\AppData\Local\Programs\Python\Python311\Lib\site-packages\pandas\core\computation\expr.py", line 415, in visit
    return visitor(node, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\tsalvatierra\AppData\Local\Programs\Python\Python311\Lib\site-packages\pandas\core\computation\expr.py", line 421, in visit_Module
    return self.visit(expr, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\tsalvatierra\AppData\Local\Programs\Python\Python311\Lib\site-packages\pandas\core\computation\expr.py", line 415, in visit
    return visitor(node, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\tsalvatierra\AppData\Local\Programs\Python\Python311\Lib\site-packages\pandas\core\computation\expr.py", line 424, in visit_Expr
    return self.visit(node.value, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\tsalvatierra\AppData\Local\Programs\Python\Python311\Lib\site-packages\pandas\core\computation\expr.py", line 415, in visit
    return visitor(node, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\tsalvatierra\AppData\Local\Programs\Python\Python311\Lib\site-packages\pandas\core\computation\expr.py", line 719, in visit_Compare
    return self.visit(binop)
           ^^^^^^^^^^^^^^^^^
  File "C:\Users\tsalvatierra\AppData\Local\Programs\Python\Python311\Lib\site-packages\pandas\core\computation\expr.py", line 415, in visit
    return visitor(node, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\tsalvatierra\AppData\Local\Programs\Python\Python311\Lib\site-packages\pandas\core\computation\expr.py", line 535, in visit_BinOp
    op, op_class, left, right = self._maybe_transform_eq_ne(node)
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\tsalvatierra\AppData\Local\Programs\Python\Python311\Lib\site-packages\pandas\core\computation\expr.py", line 455, in _maybe_transform_eq_ne
    left = self.visit(node.left, side="left")
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\tsalvatierra\AppData\Local\Programs\Python\Python311\Lib\site-packages\pandas\core\computation\expr.py", line 415, in visit
    return visitor(node, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\tsalvatierra\AppData\Local\Programs\Python\Python311\Lib\site-packages\pandas\core\computation\expr.py", line 548, in visit_Name
    return self.term_type(node.id, self.env, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\tsalvatierra\AppData\Local\Programs\Python\Python311\Lib\site-packages\pandas\core\computation\ops.py", line 86, in __init__
    self._value = self._resolve_name()
                  ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\tsalvatierra\AppData\Local\Programs\Python\Python311\Lib\site-packages\pandas\core\computation\ops.py", line 110, in _resolve_name
    res = self.env.resolve(local_name, is_local=is_local)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\tsalvatierra\AppData\Local\Programs\Python\Python311\Lib\site-packages\pandas\core\computation\scope.py", line 246, in resolve
    raise UndefinedVariableError(key, is_local) from err
pandas.errors.UndefinedVariableError: name 'Codigo' is not defined
2025-07-15 10:56:46 - costeando.gui.leader_list_window - ERROR - Error en el procesamiento de leader list: "['Codigo'] not in index"
Traceback (most recent call last):
  File "C:\Users\tsalvatierra\Desktop\Proyectos\Costeando1.1\costeando\gui\leader_list_window.py", line 127, in procesar_leader_list
    resultado = procesar_leader_list_puro(
                ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\tsalvatierra\Desktop\Proyectos\Costeando1.1\costeando\modulos\procesamiento_leader_list.py", line 103, in procesar_leader_list_puro
    df_leader_list = pd.merge(df_leader_list,df_costo_anterior[["Codigo", "COSTO LISTA " + anio_campana_anterior,"DESCUENTO ESPECIAL","APLICA DDE CA:"]], how = "left", on="Codigo")
                                             ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\tsalvatierra\AppData\Local\Programs\Python\Python311\Lib\site-packages\pandas\core\frame.py", line 3767, in __getitem__
    indexer = self.columns._get_indexer_strict(key, "columns")[1]
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\tsalvatierra\AppData\Local\Programs\Python\Python311\Lib\site-packages\pandas\core\indexes\base.py", line 5877, in _get_indexer_strict
    self._raise_if_missing(keyarr, indexer, axis_name)
  File "C:\Users\tsalvatierra\AppData\Local\Programs\Python\Python311\Lib\site-packages\pandas\core\indexes\base.py", line 5941, in _raise_if_missing
    raise KeyError(f"{not_found} not in index")
KeyError: "['Codigo'] not in index"
2025-07-15 11:08:15 - costeando.gui.leader_list_window - ERROR - Error en el procesamiento de leader list: invalid command name ".!leaderlistwindow.!progressbar"
Traceback (most recent call last):
  File "C:\Users\tsalvatierra\Desktop\Proyectos\Costeando1.1\costeando\gui\leader_list_window.py", line 95, in procesar_con_progreso
    self.procesar_leader_list()
  File "C:\Users\tsalvatierra\Desktop\Proyectos\Costeando1.1\costeando\gui\leader_list_window.py", line 143, in procesar_leader_list
    self.ocultar_progreso()
  File "C:\Users\tsalvatierra\Desktop\Proyectos\Costeando1.1\costeando\gui\leader_list_window.py", line 86, in ocultar_progreso
    self.progress_bar.stop()
  File "C:\Users\tsalvatierra\AppData\Local\Programs\Python\Python311\Lib\tkinter\ttk.py", line 1003, in stop
    self.tk.call(self._w, "stop")
_tkinter.TclError: invalid command name ".!leaderlistwindow.!progressbar"
2025-08-13 09:05:26 - costeando.modulos.procesamiento_listado_gral - ERROR - Error durante el procesamiento de Leader List.
Traceback (most recent call last):
  File "C:\Costeando\Costeando1.1\costeando\modulos\procesamiento_listado_gral.py", line 72, in procesar_listado_gral_puro
    lista_df = [estandarizar_columna_producto(df) for df in lista_df]
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Costeando\Costeando1.1\costeando\modulos\procesamiento_listado_gral.py", line 72, in <listcomp>
    lista_df = [estandarizar_columna_producto(df) for df in lista_df]
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: estandarizar_columna_producto() missing 1 required positional argument: 'nombre_df'
2025-08-13 09:18:42 - costeando.modulos.procesamiento_listado_gral - ERROR - Error durante el procesamiento de Leader List.
Traceback (most recent call last):
  File "C:\Costeando\Costeando1.1\costeando\modulos\procesamiento_listado_gral.py", line 78, in procesar_listado_gral_puro
    lista_df = [estandarizar_columna_producto(df, nombre) for df in lista_df]
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Costeando\Costeando1.1\costeando\modulos\procesamiento_listado_gral.py", line 78, in <listcomp>
    lista_df = [estandarizar_columna_producto(df, nombre) for df in lista_df]
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Costeando\Costeando1.1\costeando\modulos\procesamiento_listado_gral.py", line 12, in estandarizar_columna_producto
    if 'Producto' in df.columns:
                     ^^^^^^^^^^
AttributeError: 'tuple' object has no attribute 'columns'
2025-08-13 09:20:17 - costeando.modulos.procesamiento_listado_gral - ERROR - Error durante el procesamiento de Leader List.
Traceback (most recent call last):
  File "C:\Users\tsalvatierra\AppData\Local\Programs\Python\Python311\Lib\site-packages\pandas\core\indexes\base.py", line 3653, in get_loc
    return self._engine.get_loc(casted_key)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "pandas\_libs\index.pyx", line 147, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\_libs\index.pyx", line 176, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\_libs\hashtable_class_helper.pxi", line 7080, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas\_libs\hashtable_class_helper.pxi", line 7088, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Codigo'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Costeando\Costeando1.1\costeando\modulos\procesamiento_listado_gral.py", line 78, in procesar_listado_gral_puro
    lista_df = [estandarizar_columna_producto(df, nombre) for df,nombre in lista_df]
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Costeando\Costeando1.1\costeando\modulos\procesamiento_listado_gral.py", line 78, in <listcomp>
    lista_df = [estandarizar_columna_producto(df, nombre) for df,nombre in lista_df]
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Costeando\Costeando1.1\costeando\modulos\procesamiento_listado_gral.py", line 18, in estandarizar_columna_producto
    df['Codigo'] = df['Codigo'].astype(str).str.strip()
                   ~~^^^^^^^^^^
  File "C:\Users\tsalvatierra\AppData\Local\Programs\Python\Python311\Lib\site-packages\pandas\core\frame.py", line 3761, in __getitem__
    indexer = self.columns.get_loc(key)
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\tsalvatierra\AppData\Local\Programs\Python\Python311\Lib\site-packages\pandas\core\indexes\base.py", line 3655, in get_loc
    raise KeyError(key) from err
KeyError: 'Codigo'
2025-08-13 09:23:02 - costeando.modulos.procesamiento_listado_gral - ERROR - Error durante el procesamiento de Leader List.
Traceback (most recent call last):
  File "C:\Users\tsalvatierra\AppData\Local\Programs\Python\Python311\Lib\site-packages\pandas\core\indexes\base.py", line 3653, in get_loc
    return self._engine.get_loc(casted_key)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "pandas\_libs\index.pyx", line 147, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\_libs\index.pyx", line 176, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\_libs\hashtable_class_helper.pxi", line 7080, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas\_libs\hashtable_class_helper.pxi", line 7088, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Costo Lista'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Costeando\Costeando1.1\costeando\modulos\procesamiento_listado_gral.py", line 143, in procesar_listado_gral_puro
    df_listado_general["Costo sin Descuento C"+campania] = df_listado_general["Costo Lista"] / (df_listado_general["% Sumatoria de Descuentos"]/100)
                                                           ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
  File "C:\Users\tsalvatierra\AppData\Local\Programs\Python\Python311\Lib\site-packages\pandas\core\frame.py", line 3761, in __getitem__
    indexer = self.columns.get_loc(key)
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\tsalvatierra\AppData\Local\Programs\Python\Python311\Lib\site-packages\pandas\core\indexes\base.py", line 3655, in get_loc
    raise KeyError(key) from err
KeyError: 'Costo Lista'
2025-08-13 09:41:03 - costeando.modulos.procesamiento_listado_gral - ERROR - Error durante el procesamiento de Leader List.
Traceback (most recent call last):
  File "C:\Users\tsalvatierra\AppData\Local\Programs\Python\Python311\Lib\site-packages\pandas\core\indexes\base.py", line 3653, in get_loc
    return self._engine.get_loc(casted_key)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "pandas\_libs\index.pyx", line 147, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\_libs\index.pyx", line 176, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\_libs\hashtable_class_helper.pxi", line 7080, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas\_libs\hashtable_class_helper.pxi", line 7088, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Costo Lista'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Costeando\Costeando1.1\costeando\modulos\procesamiento_listado_gral.py", line 146, in procesar_listado_gral_puro
    df_listado_general["Descuento aplicado $"] = df_listado_general["Costo Lista"] - df_listado_general["Costo sin Descuento C"+campania]
                                                 ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
  File "C:\Users\tsalvatierra\AppData\Local\Programs\Python\Python311\Lib\site-packages\pandas\core\frame.py", line 3761, in __getitem__
    indexer = self.columns.get_loc(key)
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\tsalvatierra\AppData\Local\Programs\Python\Python311\Lib\site-packages\pandas\core\indexes\base.py", line 3655, in get_loc
    raise KeyError(key) from err
KeyError: 'Costo Lista'
2025-08-13 09:42:11 - costeando.modulos.procesamiento_listado_gral - ERROR - Error durante el procesamiento de Leader List.
Traceback (most recent call last):
  File "C:\Costeando\Costeando1.1\costeando\modulos\procesamiento_listado_gral.py", line 153, in procesar_listado_gral_puro
    df_listado_general.to_excel(path_listado, index=False, engine="openpyxl")
  File "C:\Users\tsalvatierra\AppData\Local\Programs\Python\Python311\Lib\site-packages\pandas\core\generic.py", line 2252, in to_excel
    formatter.write(
  File "C:\Users\tsalvatierra\AppData\Local\Programs\Python\Python311\Lib\site-packages\pandas\io\formats\excel.py", line 934, in write
    writer = ExcelWriter(  # type: ignore[abstract]
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\tsalvatierra\AppData\Local\Programs\Python\Python311\Lib\site-packages\pandas\io\excel\_openpyxl.py", line 60, in __init__
    super().__init__(
  File "C:\Users\tsalvatierra\AppData\Local\Programs\Python\Python311\Lib\site-packages\pandas\io\excel\_base.py", line 1219, in __init__
    self._handles = get_handle(
                    ^^^^^^^^^^^
  File "C:\Users\tsalvatierra\AppData\Local\Programs\Python\Python311\Lib\site-packages\pandas\io\common.py", line 737, in get_handle
    check_parent_directory(str(handle))
  File "C:\Users\tsalvatierra\AppData\Local\Programs\Python\Python311\Lib\site-packages\pandas\io\common.py", line 600, in check_parent_directory
    raise OSError(rf"Cannot save file into a non-existent directory: '{parent}'")
OSError: Cannot save file into a non-existent directory: 'Z:\Costos\Compartido\517 c17-2025\LISTA 517\PRUEBAS.xlsx'
